#include <stdio.h>
#include <limits.h>
#include <stdlib.h>
typedef struct{
    int ğŸ˜…;
    int ğŸ˜‰ğŸ˜‰;}ğŸ™‚;
typedef struct{
    ğŸ™‚ **ğŸ˜‰;
    int ğŸ˜‡ğŸ˜‡ğŸ˜‡;
    int ğŸ˜‡;
    int ğŸ˜š;
    int ğŸ˜›;
    int ğŸ˜‘ğŸ˜‘ğŸ˜‘ğŸ˜‘;}ğŸ¤‘;
typedef struct{
    ğŸ¤‘ **ğŸ¤¯ğŸ¤¯ğŸ¤¯;
    int ğŸ˜´;
    int ğŸ¤¥;}ğŸ¤¯;
typedef struct{
    int *ğŸ––ğŸ––ğŸ––;
    int *ğŸ––;
    int *ğŸ˜ğŸ˜ğŸ˜;
    int len;
    int size;}ğŸ¤ ;
void ğŸ––(ğŸ¤¯ *ğŸ¤,int ğŸ‘){
    if(ğŸ¤->ğŸ¤¥<ğŸ‘+1){
        int size=ğŸ¤->ğŸ¤¥*2>ğŸ‘?ğŸ¤->ğŸ¤¥*2:ğŸ‘+4;ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯=realloc(ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯,size*sizeof(ğŸ¤‘ *));
        for(int j=ğŸ¤->ğŸ¤¥;j<size;j++)ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[j]=NULL;ğŸ¤->ğŸ¤¥=size;}
    if(!ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[ğŸ‘]){
        ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[ğŸ‘]=calloc(1,sizeof(ğŸ¤‘));ğŸ¤->ğŸ˜´++;}} 
void ğŸ§ ğŸ§ ğŸ§ (ğŸ¤¯ *ğŸ¤,int a,int b,int w){
    a=a-'a';
    b=b-'a';
    ğŸ––(ğŸ¤,a);
    ğŸ––(ğŸ¤,b);
    ğŸ¤‘ *v=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[a];
    if (v->ğŸ˜‡ğŸ˜‡ğŸ˜‡>=v->ğŸ˜‡){
        v->ğŸ˜‡=v->ğŸ˜‡?v->ğŸ˜‡*2:4;v->ğŸ˜‰=realloc(v->ğŸ˜‰,v->ğŸ˜‡*sizeof(ğŸ™‚ *));}
    ğŸ™‚ *e=calloc(1,sizeof(ğŸ™‚));
    e->ğŸ˜…=b;
    e->ğŸ˜‰ğŸ˜‰=w;
    v->ğŸ˜‰[v->ğŸ˜‡ğŸ˜‡ğŸ˜‡++]=e;}
ğŸ¤  *ğŸ¦´ğŸ¦´(int n){
    ğŸ¤  *h=calloc(1,sizeof(ğŸ¤ ));h->ğŸ––ğŸ––ğŸ––=calloc(n+1,sizeof(int));h->ğŸ––=calloc(n+1,sizeof(int));
    h->ğŸ˜ğŸ˜ğŸ˜=calloc(n,sizeof(int));return(h);}
void ğŸ¦´(ğŸ¤  *h,int v,int p){
    int ğŸ‘=h->ğŸ˜ğŸ˜ğŸ˜[v]==0?++h->len:h->ğŸ˜ğŸ˜ğŸ˜[v];
    int j=ğŸ‘/2;
    while(ğŸ‘>1){
        if(h->ğŸ––[j]<p)break;
        h->ğŸ––ğŸ––ğŸ––[ğŸ‘]=h->ğŸ––ğŸ––ğŸ––[j];
        h->ğŸ––[ğŸ‘]=h->ğŸ––[j];
        h->ğŸ˜ğŸ˜ğŸ˜[h->ğŸ––ğŸ––ğŸ––[ğŸ‘]]=ğŸ‘;
        ğŸ‘=j;
        j=j/2;}
    h->ğŸ––ğŸ––ğŸ––[ğŸ‘]=v;h->ğŸ––[ğŸ‘]=p;h->ğŸ˜ğŸ˜ğŸ˜[v]=ğŸ‘;}
int min(ğŸ¤  *h,int ğŸ‘,int j,int k){
    int m=ğŸ‘;
    if(j<=h->len&&h->ğŸ––[j]<h->ğŸ––[m])m=j;if(k<=h->len&&h->ğŸ––[k]<h->ğŸ––[m])m=k;
    return(m);}
int ğŸ‘¨(ğŸ¤  *h){
    int v=h->ğŸ––ğŸ––ğŸ––[1];
    int ğŸ‘=1;
    while(1){
        int j=min(h,h->len,2*ğŸ‘,2*ğŸ‘+1);
        if(j==h->len)break;
        h->ğŸ––ğŸ––ğŸ––[ğŸ‘]=h->ğŸ––ğŸ––ğŸ––[j];
        h->ğŸ––[ğŸ‘]=h->ğŸ––[j];
        h->ğŸ˜ğŸ˜ğŸ˜[h->ğŸ––ğŸ––ğŸ––[ğŸ‘]]=ğŸ‘;
        ğŸ‘=j;}
    h->ğŸ––ğŸ––ğŸ––[ğŸ‘]=h->ğŸ––ğŸ––ğŸ––[h->len];
    h->ğŸ––[ğŸ‘]=h->ğŸ––[h->len];
    h->ğŸ˜ğŸ˜ğŸ˜[h->ğŸ––ğŸ––ğŸ––[ğŸ‘]]=ğŸ‘;
    h->len--;
    return(v);}
void ğŸ§”(ğŸ¤¯ *ğŸ¤,int a,int b){
    int ğŸ‘,j;
    a=a-'a';
    b=b-'a';
    for(ğŸ‘=0;ğŸ‘<ğŸ¤->ğŸ˜´;ğŸ‘++){
        ğŸ¤‘ *v=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[ğŸ‘];
        v->ğŸ˜š=INT_MAX;
        v->ğŸ˜›=0;
        v->ğŸ˜‘ğŸ˜‘ğŸ˜‘ğŸ˜‘=0;}
    ğŸ¤‘ *v=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[a];
    v->ğŸ˜š=(0);
    ğŸ¤  *h=ğŸ¦´ğŸ¦´(ğŸ¤->ğŸ˜´);
    ğŸ¦´(h,a,v->ğŸ˜š);while(h->len){
        ğŸ‘=ğŸ‘¨(h);if(ğŸ‘==b)break;
        v=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[ğŸ‘];
        v->ğŸ˜‘ğŸ˜‘ğŸ˜‘ğŸ˜‘=1;
        for(j=0;j<v->ğŸ˜‡ğŸ˜‡ğŸ˜‡;j++){
            ğŸ™‚ *e=v->ğŸ˜‰[j];
            ğŸ¤‘ *u=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[e->ğŸ˜…];if(!u->ğŸ˜‘ğŸ˜‘ğŸ˜‘ğŸ˜‘&&v->ğŸ˜š+e->ğŸ˜‰ğŸ˜‰<=u->ğŸ˜š){
                u->ğŸ˜›=ğŸ‘;
                u->ğŸ˜š=v->ğŸ˜š+e->ğŸ˜‰ğŸ˜‰;
                ğŸ¦´(h,e->ğŸ˜…,u->ğŸ˜š);}}}}
void ğŸ§”ğŸ§”(ğŸ¤¯ *ğŸ¤,int ğŸ‘){
    int n,j;
    ğŸ¤‘ *v,*u;
    ğŸ‘=ğŸ‘-'a';
    v=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[ğŸ‘];
    if(v->ğŸ˜š==INT_MAX){
        printf("lmao you got mathematically cucked, broseph\n");return;}for(n=1,u=v;u->ğŸ˜š;u=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[u->ğŸ˜›],n++);
    char *path=malloc(n);
    path[n-1]='a'+ğŸ‘;
    for(j=0,u=v;u->ğŸ˜š;u=ğŸ¤->ğŸ¤¯ğŸ¤¯ğŸ¤¯[u->ğŸ˜›],j++)path[n-j-2]='a'+u->ğŸ˜›;
    printf("%d %.*s\n",v->ğŸ˜š,n,path);}
    int main(){
    ğŸ¤¯ *ğŸ¤=calloc(1,sizeof(ğŸ¤¯));
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'a','b',7);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'a','c',9);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'a','f',14);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'b','c',10);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'b','d',15);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'c','d',11);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'c','f',2);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'d','e',6);
    ğŸ§ ğŸ§ ğŸ§ (ğŸ¤,'e','f',9);
    ğŸ§”(ğŸ¤,'a','e');
    ğŸ§”ğŸ§”(ğŸ¤,'e');
    return(0);}
